
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://front-matter.github.io/ckan-documentation/installation/">
      
      
        <link rel="prev" href="../getting_started/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.3">
    
    
      
        <title>Installation - CKAN Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CKAN Documentation" class="md-header__button md-logo" aria-label="CKAN Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CKAN Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Installation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/front-matter/ckan-documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CKAN Documentation" class="md-nav__button md-logo" aria-label="CKAN Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CKAN Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/front-matter/ckan-documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Installation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    System requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#package-installation" class="md-nav__link">
    Package installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-configure-postgresql" class="md-nav__link">
    Install and configure PostgreSQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-configure-solr" class="md-nav__link">
    Install and configure Solr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-the-web-server" class="md-nav__link">
    Configure the Web Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-a-writable-directory" class="md-nav__link">
    Set up a writable directory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-ckan" class="md-nav__link">
    Configure CKAN
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    System requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#package-installation" class="md-nav__link">
    Package installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-configure-postgresql" class="md-nav__link">
    Install and configure PostgreSQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-configure-solr" class="md-nav__link">
    Install and configure Solr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-the-web-server" class="md-nav__link">
    Configure the Web Server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-a-writable-directory" class="md-nav__link">
    Set up a writable directory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-ckan" class="md-nav__link">
    Configure CKAN
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="installation">Installation</h1>
<h2 id="system-requirements">System requirements</h2>
<p>For a small to medium CKAN implementation, it is recommended the frontend (Web) and backend (db and solr) run on separate machines (Physical or VM's). The following is suggested as a minimum for each machine:</p>
<ul>
<li>2 CPU cores</li>
<li>4 GB of RAM</li>
<li>AMD64 (x86_64) architecture</li>
<li>60 GB of disk space</li>
</ul>
<p>If you wish to run both frontend and backend on the same machine, you will almost certainly want to use 4(+) CPU cores.</p>
<p>The (primary) CKAN server should have a public IP address and a domain name (e.g. <code>demo.ckan.org</code>). We will install a free SSL certificate for this domain using Let's Encrypt.</p>
<h2 id="package-installation">Package installation</h2>
<p>These instructions assume you are using Ubuntu 22.04 and do a package install, the quickest and easiest way to install CKAN. Other installation options are installation from source and installation using Docker.</p>
<p>You should install CKAN from package if:</p>
<ul>
<li>You want to install CKAN on an Ubuntu 20.04 or 22.04, 64-bit server, and</li>
<li>You only want to run one CKAN website per server</li>
</ul>
<p>Update Ubuntu's package index.</p>
<pre><code class="language-bash">sudo apt update
</code></pre>
<p>Install the Ubuntu packages that CKAN requires (and <code>git</code>, to enable you to install CKAN extensions).</p>
<pre><code class="language-bash">sudo apt install -y libpq5 redis-server nginx supervisor git
</code></pre>
<p>Download the CKAN package.</p>
<pre><code class="language-bash">wget https://packaging.ckan.org/python-ckan_2.10-jammy_amd64.deb
</code></pre>
<p>Install the CKAN package.</p>
<pre><code class="language-bash">sudo dpkg -i python-ckan_2.10-jammy_amd64.deb
</code></pre>
<h2 id="install-and-configure-postgresql">Install and configure PostgreSQL</h2>
<p>!!! Tip
    You can install PostgreSQL and CKAN on different servers. Just change the sqlalchemy.url setting in your <code>/etc/ckan/default/ckan.ini</code> file to reference your PostgreSQL server.</p>
<p>Install PostgreSQL required packages.</p>
<pre><code class="language-bash">sudo apt install -y postgresql
</code></pre>
<p>Next you’ll need to create a database user if one doesn’t already exist. Create a new PostgreSQL user called ckan_default, and enter a password for the user when prompted. You’ll need this password later.</p>
<pre><code class="language-bash">sudo -u postgres createuser -S -D -R -P ckan_default
</code></pre>
<p>Create a new PostgreSQL database, called ckan_default, owned by the database user you just created.</p>
<pre><code class="language-bash">sudo -u postgres createdb -O ckan_default ckan_default -E utf-8
</code></pre>
<p>Edit the sqlalchemy.url option in your CKAN configuration file (<code>/etc/ckan/default/ckan.ini</code>) file and set the correct password, database and database user.</p>
<pre><code class="language-bash">sudo nano /etc/ckan/default/ckan.ini
</code></pre>
<h2 id="install-and-configure-solr">Install and configure Solr</h2>
<p>The following instructions have been tested in Ubuntu 22.04 and are provided as a guidance only. </p>
<pre><code class="language-bash">sudo apt-get install openjdk-8-jdk
</code></pre>
<p>Download the latest supported version from the Solr downloads page. CKAN supports Solr version 8.x.</p>
<pre><code class="language-bash">wget https://downloads.apache.org/lucene/solr/8.11.2/solr-8.11.2.tgz
</code></pre>
<p>Extract the install script file to your desired location.</p>
<pre><code class="language-bash">tar xzf solr-8.11.2.tgz solr-8.11.2/bin/install_solr_service.sh --strip-components=2
</code></pre>
<p>Run the installation script.</p>
<pre><code class="language-bash">sudo bash ./install_solr_service.sh solr-8.11.2.tgz
</code></pre>
<p>Create a new core for CKAN.</p>
<pre><code class="language-bash">sudo -u solr /opt/solr/bin/solr create -c ckan
</code></pre>
<p>Replace the standard schema with the CKAN one.</p>
<pre><code class="language-bash">sudo -u solr wget -O /var/solr/data/ckan/conf/managed-schema https://raw.githubusercontent.com/ckan/ckan/dev-v2.10/ckan/config/solr/schema.xml
</code></pre>
<p>Restart Solr.</p>
<pre><code class="language-bash">sudo service solr restart
</code></pre>
<h2 id="configure-the-web-server">Configure the Web Server</h2>
<p>Configure Nginx to serve your CKAN site. Edit the Nginx config file (/etc/nginx/sites-available/ckan) that was installed by the CKAN package and insert the <code>server_name</code> variable in the <code>server</code> block.</p>
<pre><code class="language-bash">sudo nano /etc/nginx/sites-available/ckan
</code></pre>
<pre><code class="language-bash">server {
  client_max_body_size 100M;
  server_name demo.ckan.org;
  location /
...
</code></pre>
<p>Restart Nginx.</p>
<pre><code class="language-bash">sudo service nginx restart
</code></pre>
<p>Configure the firewall to allow access to the CKAN web server via HTTP, HTTPS and SSH only.</p>
<p>Allow access to the CKAN web server via HTTP and HTTPS.</p>
<pre><code class="language-bash">sudo ufw allow 'Nginx Full'
</code></pre>
<p>Allow access to the CKAN web server via SSH.</p>
<pre><code class="language-bash">sudo ufw allow ssh
</code></pre>
<p>Enable the firewall.</p>
<pre><code class="language-bash">sudo ufw enable
</code></pre>
<p>Install a free SSL certificate for your domain using Let's Encrypt.</p>
<pre><code class="language-bash">
```bash o

Install certbot to obtain a free SSL certificate for Nginx on Ubuntu 22.04.

```bash
sudo snap install core; sudo snap refresh core
sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot
</code></pre>
<p>Request a certificate for your domain. You will be prompted to enter an email address and agree to the terms of service. Certbot will automatically configure Nginx to use the certificate.</p>
<pre><code class="language-bash">sudo certbot --nginx -d demo.ckan.org
</code></pre>
<h2 id="set-up-a-writable-directory">Set up a writable directory</h2>
<p>CKAN needs a directory where it can write certain files, regardless of whether you are using the FileStore and file uploads or not (if you do want to enable file uploads, set the ckan.storage_path configuration option in the next section).</p>
<p>Create the directory where CKAN will be able to write files.</p>
<pre><code class="language-bash">sudo mkdir -p /var/lib/ckan/default
</code></pre>
<p>Set the permissions of this directory. If you’re running CKAN with Nginx, then the Nginx’s user (<code>www-data</code> on Ubuntu) must have read, write and execute permissions on it.</p>
<pre><code class="language-bash">sudo chown www-data /var/lib/ckan/default
sudo chmod u+rwx /var/lib/ckan/default
</code></pre>
<h2 id="configure-ckan">Configure CKAN</h2>
<p>Edit the CKAN configuration file (/etc/ckan/default/ckan.ini) to set up the following options.</p>
<pre><code class="language-bash">sudo nano /etc/ckan/default/ckan.ini
</code></pre>
<p>Each CKAN site should have a unique <code>site_id</code>, for example</p>
<pre><code class="language-bash">ckan.site_id = default
</code></pre>
<p>Provide the site’s URL. For example</p>
<pre><code class="language-bash">ckan.site_url = http://demo.ckan.org
</code></pre>
<p>Initialize your CKAN database by running this command in a terminal.</p>
<pre><code class="language-bash">sudo ckan db init
</code></pre>
<p>Reload the Supervisor daemon so the new processes are picked up</p>
<pre><code class="language-bash">sudo supervisorctl reload
</code></pre>
<p>Restart the web server.</p>
<pre><code class="language-bash">sudo service nginx restart
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>